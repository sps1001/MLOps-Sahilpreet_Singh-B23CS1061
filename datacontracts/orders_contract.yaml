---
# ═══════════════════════════════════════════════════════════════════════════
# DATA CONTRACT: Flash Sale Order Stream
# ═══════════════════════════════════════════════════════════════════════════

dataContractSpecification: 0.9.3
id: urn:datacontract:ecommerce:orders
version: 1.0.0

# ───────────────────────────────────────────────────────────────────────────
# 1. OWNERSHIP & GOVERNANCE
# ───────────────────────────────────────────────────────────────────────────
info:
  title: "Flash Sale Order Stream"
  description: |
    Real-time feed of orders for Black Friday marketing dashboards.
    Ensures safe mapping of numeric status codes to logical strings.
  owner: "E-commerce Platform Team"
  contact:
    name: "Sahil Kamboj (B23CS1061)"
    email: "b23cs1061@iitj.ac.in"
  classification: internal
  tags: [ecommerce, orders, black-friday]

# ───────────────────────────────────────────────────────────────────────────
# 2. SCHEMA DEFINITION (Logical Contract)
# ───────────────────────────────────────────────────────────────────────────
schema:
  type: object
  properties:
    order_total:
      type: number
      description: "Total order value in USD"
      minimum: 0.0
      physical_mapping: o_total

    status:
      type: string
      enum: [PAID, SHIPPED, CANCELLED]
      description: |
        Logical fulfillment status.
        Mapped from physical codes: 2=PAID, 5=SHIPPED, 9=CANCELLED.
      physical_mapping: status_code

  required: [order_total, status]

# ───────────────────────────────────────────────────────────────────────────
# 3. SERVICE LEVEL AGREEMENTS (SLAs)
# ───────────────────────────────────────────────────────────────────────────
sla:
  freshness:
    threshold: "1 minute"
    description: "Real-time stream for dashboard updates during sale events"
  availability:
    percentage: "99.99%"
    description: "High availability required during peak sale periods"

# ───────────────────────────────────────────────────────────────────────────
# 4. DATA QUALITY RULES
# ───────────────────────────────────────────────────────────────────────────
quality:
  - name: order_total_non_negative
    type: validity
    expression: "order_total >= 0"
    threshold: "100%"
    enforcement: hard
    description: "Order totals must be non-negative"

  - name: status_valid_enum
    type: validity
    expression: "status IN ('PAID', 'SHIPPED', 'CANCELLED')"
    threshold: "100%"
    enforcement: hard
    description: "Status must be one of the predefined logical states"

  - name: status_code_mapping_rejection
    type: validity
    expression: "status_code IN (2, 5, 9)"
    threshold: "100%"
    enforcement: hard
    description: |
      Reject any records with unmapped physical status codes (any
      codes other than 2, 5, or 9)
